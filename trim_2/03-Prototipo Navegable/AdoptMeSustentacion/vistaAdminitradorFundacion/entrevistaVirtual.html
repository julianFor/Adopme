<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Seguimiento de Adopci√≥n</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/espera.css">
  <link rel="stylesheet" href="/css/entregables.css">
  <link rel="stylesheet" href="/css/styles.css">
  <link rel="icon" href="/img/IconoMorado.png" type="image/png">
  <style>
    .padre {
      font-family: 'Poppins', sans-serif;
      padding: 40px;
      text-align: center;
    }

    h2 {
      color: #B75DFC;
      font-weight: 600;
      margin-bottom: 40px;
    }

    .linea-progreso {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 1000px;
      margin: 0 auto;
      position: relative;
    }

    .linea-progreso::before {
      content: "";
      position: absolute;
      top: 50%;
      left: 0;
      width: 100%;
      height: 4px;
      background-color: #dcd1f9;
      z-index: 0;
    }

    .etapa {
      background-color: #f1eefb;
      border-radius: 15px;
      padding: 20px;
      width: 140px;
      z-index: 1;
      color: #888;
    }

    .etapa.completada {
      background-color: #c6f8d6;
      color: #000;
    }

    .etapa.actual {
      background-color: #fff8d6;
      border: 2px solid #fdd835;
      color: #000;
    }

    .icono {
      font-size: 30px;
      margin-bottom: 10px;
    }

    .acciones {
      margin-top: 40px;
    }

    .acciones label {
      display: block;
      margin-bottom: 10px;
      font-weight: 500;
    }

    .acciones input[type="text"],
    .acciones input[type="date"],
    .acciones input[type="time"] {
      padding: 10px;
      width: 300px;
      max-width: 90%;
      border-radius: 8px;
      border: 1px solid #ccc;
      margin-bottom: 20px;
    }

    .acciones button {
      background-color: #B75DFC;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      margin: 0 10px;
    }

    .timeline {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 1000px;
      margin: 20px auto;
    }

    .step {
      text-align: center;
      cursor: pointer;
      padding: 10px;
      border-radius: 12px;
      width: 120px;
    }

    .step img {
      width: 40px;
      height: 40px;
      margin-bottom: 5px;
    }

    .step.completed {
      background-color: #c6f8d6;
    }

    .step.active {
      background-color: #fff8d6;
      border: 2px solid #fdd835;
    }

    .step.pending {
      background-color: #f1eefb;
      color: #aaa;
    }

    .botones-navegacion{
      margin-top: 40px;
      display: flex;
      justify-content: space-between;
    }

    .aprobar {
      padding: 15px 18px;
      border-radius: 8px;
      font-size: 15px;
      border: none;
      cursor: pointer;
      color: white;
      background-color: #63646369;
    }
    .rechazar {
      padding: 15px 18px;
      border-radius: 8px;
      font-size: 15px;
      border: none;
      cursor: pointer;
      color: white;
      background-color: #63D471;
    }
  </style>
</head>
<body>
  <header>
    <div class="logo">
        <img src="/img/logo.png" alt="AdoptMe Logo">
    </div>
    <nav>
        <ul>
            <li><a href="/vistaAdminitradorFundacion/indexAdministradorFundacion.html">Inicio</a></li>
            <li><a href="/vistaAdminitradorFundacion/gestionAdministradorFundacion.html">Gestion</a></li>
        </ul>
    </nav>
    <div>
        <button class="btn" onclick="abrirModal('loginModal')"><ion-icon name="person"></ion-icon></button>
    </div>
  </header>

  <div class="wrapper">
    <div class="sidebar">
      <h2 id="tituloEntregable">gestionar</h2>
      <ul>
        <li><a href="/vistaAdminitradorFundacion/gestionMascotasFundacion.html"><i class="fas fa-user"></i>Gestion Mascotas</a></li>
        <li><a href="/vistaAdminitradorFundacion/gestionSolicitudesFundacion.html"><i class="fas fa-address-card"></i>Gestion Solicitudes</a></li>
        <li><a href="#"><i class="fas fa-user"></i>Seguimientos Adopcion</a></li>
      </ul> 
    </div>   
  </div>

  <main class="container">
    <h2>Tu progreso</h2>

    <div class="line">
      <div class="dot completed-dot"></div>
      <div class="dot completed-dot"></div>
      <div class="dot active-dot"></div>
      <div class="dot pending-dot"></div>
      <div class="dot pending-dot"></div>
      <div class="dot pending-dot"></div>
    </div>

    <div class="timeline">
      <div class="step completed" onclick="irASeccion('formulario')">
        <img src="https://img.icons8.com/ios-filled/100/document--v1.png" alt="Formulario">
        <p>Formulario Completado</p>
      </div>
      <div class="step completed" onclick="irASeccion('confirmacion')">
        <img src="https://img.icons8.com/ios-filled/100/checked.png" alt="Confirmaci√≥n">
        <p>Confirmaci√≥n de Datos</p>
      </div>
      <div class="step active" onclick="irASeccion('entrevista')">
        <img src="https://img.icons8.com/ios-filled/100/conference-call.png" alt="Entrevista">
        <p>Entrevista Virtual</p>
      </div>
      <div class="step pending" onclick="irASeccion('visita')">
        <img src="https://img.icons8.com/ios-filled/100/dog-house.png" alt="Visita">
        <p>Visita al Refugio</p>
      </div>
      <div class="step pending" onclick="irASeccion('aprobacion')">
        <img src="https://img.icons8.com/ios-filled/100/approval.png" alt="Aprobaci√≥n">
        <p>Firmar Compromiso</p>
      </div>
      <div class="step pending" onclick="irASeccion('entrega')">
        <img src="https://img.icons8.com/ios-filled/100/delivery.png" alt="Entrega">
        <p>Entrega de la Mascota</p>
      </div>
    </div>

    <!-- SECCIONES -->
    <div id="formulario" class="seccion" style="display: none;">
      <div class="seccion">
        <h3>üìå Informaci√≥n Personal</h3>
        <p style="background-color: #e1ffe6; padding: 15px; border-radius: 8px; color: #2e7d32;">
          ‚úÖ El formulario del adoptante ha sido aprobado. Puedes continuar con el proceso.
        </p>
        <div class="campo"><strong>Nombre:</strong> Juan P√©rez</div>
        <div class="campo"><strong>C√©dula:</strong> 123456789</div>
        <div class="campo"><strong>Fecha de nacimiento:</strong> 10/01/1995</div>
        <div class="campo"><strong>Direcci√≥n:</strong> Calle 123 #45-67</div>
        <div class="campo"><strong>Barrio/Localidad:</strong> Suba</div>
        <div class="campo"><strong>Ciudad:</strong> Bogot√°</div>
        <div class="campo"><strong>Tel√©fono:</strong> 3204567890</div>
        <div class="campo"><strong>Correo:</strong> juanperez@mail.com</div>
    </div>

    <div class="seccion">
        <h3>üè† Informaci√≥n sobre el Hogar</h3>
        <div class="campo"><strong>Tipo de vivienda:</strong> Casa</div>
        <div class="campo"><strong>Propiedad:</strong> Propia</div>
        <div class="campo"><strong>Todos est√°n de acuerdo con la adopci√≥n:</strong> S√≠</div>
        <div class="campo"><strong>Ni√±os en casa:</strong> S√≠</div>
        <div class="campo"><strong>Otras mascotas:</strong> No</div>
        <div class="campo"><strong>Alergias en casa:</strong> No</div>
    </div>

    <div class="seccion">
        <h3>üìÑ Informaci√≥n sobre la Adopci√≥n</h3>
        <div class="campo"><strong>¬øPor qu√© deseas adoptar?:</strong> Me encantan los animales y quiero dar hogar a uno necesitado.</div>
        <div class="campo"><strong>¬øD√≥nde vivir√° la mascota?:</strong> Dentro de la casa</div>
        <div class="campo"><strong>¬øY si presenta problemas?:</strong> Consultar√© a un veterinario o et√≥logo.</div>
        <div class="campo"><strong>Tiempo solo diariamente:</strong> 4 horas</div>
        <div class="campo"><strong>Responsable principal:</strong> Yo mismo</div>
        <div class="campo"><strong>¬øY si te mudas?:</strong> Buscar√© alternativas para llevarla conmigo o reubicarla responsablemente.</div>
    </div>

    <div class="seccion">
        <h3>üîí Compromiso y Responsabilidad</h3>
        <div class="campo">Recibir visita virtual: S√≠</div>
        <div class="campo">Compromiso con cuidados: S√≠</div>
        <div class="campo">Firmar contrato: S√≠</div>
    </div>

    <div class="documentos">
        <h3>üìÇ Documentos Adjuntos</h3>
        <div class="campo">Documento de identidad: <a href="#">ver_doc.pdf</a></div>
        <div class="campo">Prueba de residencia: <a href="#">recibo_luz.pdf</a></div>
    </div>

    <div class="condiciones">
        <h3>üî¢ Confirmaciones y Condiciones</h3>
        <ul>
        <li>Acepta condiciones generales</li>
        <li>No solicita pagos por adopci√≥n</li>
        <li>Dispuesto a videollamada o visita</li>
        <li>Confirmaci√≥n final aceptada</li>
        </ul>
    </div>
    </div>
    <div id="confirmacion" class="seccion" style="display: none;">
      <div class="acciones">
        <h3>üìå Confirmaci√≥n de Datos</h3>
    
        <p style="background-color: #e1ffe6; padding: 15px; border-radius: 8px; color: #2e7d32;">
          ‚úÖ El formulario del adoptante ha sido aprobado. Puedes continuar con el proceso.
        </p>
    
        <label for="observacionesConfirmacion">üìù Observaciones internas:</label>
        <input type="text" id="observacionesConfirmacion" placeholder="Escribe tus notas aqu√≠...">
    
        <div style="margin-top: 20px;">
          <button onclick="guardarConfirmacion()">üíæ Guardar Observaci√≥n</button>
        </div>
      </div>
      <script>
        function guardarConfirmacion() {
          const obs = document.getElementById('observacionesConfirmacion').value;
          console.log("Observaci√≥n guardada:", obs);
          alert("Observaci√≥n registrada correctamente.");
        }
      </script>
      
  

    </div>
    <div id="entrevista" class="seccion" style="display: block;">
      <div class="acciones">
        <h3>üóìÔ∏è Agendar Entrevista Virtual</h3>
        <label for="fecha">Fecha:</label>
        <input type="date" id="fecha">
        <label for="hora">Hora:</label>
        <input type="time" id="hora">
        <label for="enlace">Enlace Meet:</label>
        <input type="text" id="enlace" placeholder="https://meet.google.com/xxx-xxx-xxx">
        <label for="observaciones">üìå Observaciones:</label>
        <input type="text" id="observaciones" placeholder="Notas u observaciones sobre la entrevista">
        <div>
          <button onclick="agendarCalendar()">üìÜ Agendar en Google Calendar</button>
          <button onclick="guardarEntrevista()">üìÇ Guardar Entrevista</button>
        </div>
      </div>
    </div>
    <div id="visita" class="seccion" style="display: none;">
      <div class="acciones">
        <h3>üè† Visita al Refugio</h3>
    
        <label for="fechaVisita">Fecha de la visita:</label>
        <input type="date" id="fechaVisita">
    
        <label for="horaVisita">Hora:</label>
        <input type="time" id="horaVisita">
    
        <label for="responsableVisita">üë§ Responsable en la fundaci√≥n:</label>
        <input type="text" id="responsableVisita" placeholder="Nombre del cuidador o voluntario">
    
        <label for="observacionesVisita">üìù Observaciones:</label>
        <input type="text" id="observacionesVisita" placeholder="Anota detalles relevantes de la visita">
    
        <div style="margin-top: 20px;">
          <button onclick="confirmarVisita()">‚úîÔ∏è Confirmar que la visita fue realizada</button>
          <button onclick="noAsistioVisita()">üö´ El adoptante no asisti√≥</button>
        </div>
      </div>
      <script>
        function confirmarVisita() {
          const fecha = document.getElementById('fechaVisita').value;
          const hora = document.getElementById('horaVisita').value;
          const responsable = document.getElementById('responsableVisita').value;
          const observaciones = document.getElementById('observacionesVisita').value;
      
          if (!fecha || !hora || !responsable) {
            alert("Por favor completa la fecha, hora y responsable de la visita.");
            return;
          }
      
          console.log("‚úÖ Visita confirmada:");
          console.log("Fecha:", fecha);
          console.log("Hora:", hora);
          console.log("Responsable:", responsable);
          console.log("Observaciones:", observaciones);
      
          alert("La visita ha sido confirmada con √©xito.");
          pasoSiguiente(); // avanzar a siguiente secci√≥n
        }
      
        function noAsistioVisita() {
          const observaciones = prompt("Escribe una observaci√≥n sobre por qu√© no asisti√≥ o si deseas reagendar:");
      
          if (observaciones) {
            console.log("‚ùå El adoptante NO asisti√≥ a la visita.");
            console.log("Observaci√≥n:", observaciones);
            alert("Observaci√≥n registrada. Puedes reagendar la visita si lo consideras necesario.");
          }
        }
      </script>
    </div>
    <div id="aprobacion" class="seccion" style="display: none;">
      <div class="acciones">
        <h3>‚úçÔ∏è Firma de Compromiso de Adopci√≥n</h3>
    
        <p style="text-align: left; background-color: #f1eefb; padding: 15px; border-radius: 10px;">
          Al firmar este compromiso, el adoptante declara que:
          <ul style="text-align: left; margin-left: 30px;">
            <li>Se compromete a cuidar de la mascota adoptada con responsabilidad.</li>
            <li>No la usar√° para fines de reproducci√≥n o comercio.</li>
            <li>Informar√° a la fundaci√≥n en caso de cambios importantes en su situaci√≥n.</li>
            <li>Permitira visitas o seguimiento si se considera necesario.</li>
          </ul>
        </p>
    
        <label for="nombreCompromiso">üë§ Nombre completo del adoptante:</label>
        <input type="text" id="nombreCompromiso" placeholder="Nombre completo">
    
        <label for="documentoCompromiso">üîë Documento de identidad:</label>
        <input type="text" id="documentoCompromiso" placeholder="CC/NIT/Pasaporte">
    
        <label for="fechaCompromiso">üóìÔ∏è Fecha:</label>
        <input type="date" id="fechaCompromiso">
    
        <label>üñãÔ∏è Firma digital aqu√≠:</label>
        <canvas id="signaturePad" width="500" height="150" style="border: 2px dashed #b75dfc; border-radius: 10px;"></canvas>
    
        <div style="margin: 10px 0;">
          <button onclick="clearSignature()">‚ùå Limpiar firma</button>
        </div>
    
        <div style="margin-top: 20px;">
          <button onclick="generarPDF()">üìÑ Generar PDF de Compromiso</button>
        </div>
      </div>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.5/dist/signature_pad.umd.min.js"></script>

<script>
  const canvas = document.getElementById("signaturePad");
  const signaturePad = new SignaturePad(canvas);

  function clearSignature() {
    signaturePad.clear();
  }

  async function generarPDF() {
    const nombre = document.getElementById("nombreCompromiso").value;
    const doc = document.getElementById("documentoCompromiso").value;
    const fecha = document.getElementById("fechaCompromiso").value;

    if (!nombre || !doc || !fecha || signaturePad.isEmpty()) {
      alert("Por favor completa todos los campos y realiza la firma.");
      return;
    }

    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF();

    pdf.setFont("helvetica", "");
    pdf.setFontSize(12);
    pdf.text("Compromiso de Adopci√≥n - AdoptMe", 20, 20);

    pdf.text(`Nombre del adoptante: ${nombre}`, 20, 40);
    pdf.text(`Documento: ${doc}`, 20, 50);
    pdf.text(`Fecha: ${fecha}`, 20, 60);

    const texto = [
      "Me comprometo a brindar cuidados adecuados a la mascota adoptada,",
      "informar a la fundaci√≥n sobre cualquier cambio relevante,",
      "y permitir seguimiento post-adopci√≥n si es necesario."
    ];
    pdf.text(texto, 20, 80);

    const imageData = signaturePad.toDataURL();
    pdf.addImage(imageData, 'PNG', 20, 110, 160, 40);

    pdf.save(`Compromiso_Adopcion_${nombre.replace(/\s+/g, '_')}.pdf`);
  }
</script>
    </div>
    <div id="entrega" class="seccion" style="display: none;">
      <div class="acciones">
        <h3>üöö Entrega de la Mascota</h3>
    
        <label for="fechaEntrega">üìÖ Fecha de entrega:</label>
        <input type="date" id="fechaEntrega">
    
        <label for="recibidoPor">üë§ Nombre de quien recibe la mascota:</label>
        <input type="text" id="recibidoPor" placeholder="Nombre del adoptante o autorizado">
    
        <label for="observacionesEntrega">üìù Observaciones de entrega:</label>
        <input type="text" id="observacionesEntrega" placeholder="Ej. Entrega sin novedades, se explic√≥ plan de vacunas...">
    
        <!-- Subida de imagen (opcional) -->
        <!--
        <label for="evidenciaEntrega">üì∑ Foto de entrega (opcional):</label>
        <input type="file" id="evidenciaEntrega" accept="image/*">
        -->
    
        <div style="margin-top: 20px;">
          <button onclick="confirmarEntrega()">‚úÖ Confirmar entrega</button>
        </div>
      </div>
      <script>
        function confirmarEntrega() {
          const fecha = document.getElementById('fechaEntrega').value;
          const recibidoPor = document.getElementById('recibidoPor').value;
          const observaciones = document.getElementById('observacionesEntrega').value;
      
          if (!fecha || !recibidoPor) {
            alert("Por favor completa la fecha y nombre de quien recibi√≥ la mascota.");
            return;
          }
      
          console.log("üêæ Entrega registrada:");
          console.log("Fecha:", fecha);
          console.log("Recibido por:", recibidoPor);
          console.log("Observaciones:", observaciones);
      
          alert("Entrega registrada con √©xito. ¬°Gracias por completar el proceso!");
          pasoSiguiente(); // finalizar proceso
        }
      </script>
      
    </div>

    <!-- BOTONES -->
    <div class="botones-navegacion">
      <button class="aprobar" onclick="pasoAnterior()"> REGRESAR</button>
      <button class="rechazar" onclick="pasoSiguiente()"> APROBADO</button>
    </div>
  </main>

  <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>

  <script>
    let pasos = ['formulario', 'confirmacion', 'entrevista', 'visita', 'aprobacion', 'entrega'];
    let pasoActual = 2;

    function irASeccion(id) {
      pasos.forEach(p => {
        document.getElementById(p).style.display = 'none';
      });
      document.getElementById(id).style.display = 'block';
      pasoActual = pasos.indexOf(id);
    }

    function pasoAnterior() {
      if (pasoActual > 0) {
        irASeccion(pasos[pasoActual - 1]);
      }
    }

    function pasoSiguiente() {
      if (pasoActual < pasos.length - 1) {
        irASeccion(pasos[pasoActual + 1]);
      }
    }

    function guardarEntrevista() {
      const fecha = document.getElementById('fecha').value;
      const hora = document.getElementById('hora').value;
      const enlace = document.getElementById('enlace').value;
      const observaciones = document.getElementById('observaciones').value;

      if (!fecha || !hora || !enlace.startsWith("https://meet.google.com/")) {
        alert("Por favor completa todos los campos y aseg√∫rate de que el enlace Meet sea v√°lido.");
        return;
      }

      console.log("Entrevista guardada:", fecha, hora, enlace, observaciones);
      alert("Entrevista agendada con √©xito.");
    }

    function agendarCalendar() {
      const fecha = document.getElementById('fecha').value.replace(/-/g, '');
      const hora = document.getElementById('hora').value.replace(':', '') + '00';
      const enlace = encodeURIComponent(document.getElementById('enlace').value);
      const titulo = encodeURIComponent('Entrevista de Adopci√≥n - AdoptMe');
      const detalle = encodeURIComponent('Videollamada con adoptante');
      const url = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${titulo}&dates=${fecha}T${hora}Z/${fecha}T${hora}Z&details=${detalle}&location=${enlace}`;
      window.open(url, '_blank');
    }
  </script>
</body>
</html>
